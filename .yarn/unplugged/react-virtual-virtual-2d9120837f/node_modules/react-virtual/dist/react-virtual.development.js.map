{"version":3,"file":"react-virtual.development.js","sources":["../src/useIsomorphicLayoutEffect.js","../src/useScroll.js","../node_modules/@reach/observe-rect/dist/observe-rect.esm.js","../src/useRect.js","../src/index.js"],"sourcesContent":["import React from 'react'\n\nexport default typeof window !== 'undefined'\n  ? React.useLayoutEffect\n  : React.useEffect\n","import React from 'react'\n\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport default function useScroll(nodeRef, onChange) {\n  const [element, setElement] = React.useState(nodeRef.current)\n  const onChangeRef = React.useRef()\n  onChangeRef.current = onChange\n\n  useIsomorphicLayoutEffect(() => {\n    if (nodeRef.current !== element) {\n      setElement(nodeRef.current)\n    }\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    if (element) {\n      onChangeRef.current({\n        scrollLeft: element.scrollLeft,\n        scrollTop: element.scrollTop,\n      })\n    }\n  }, [element])\n\n  React.useEffect(() => {\n    if (!element) {\n      return\n    }\n\n    const handler = e => {\n      onChangeRef.current({\n        scrollLeft: e.target.scrollLeft,\n        scrollTop: e.target.scrollTop,\n      })\n    }\n\n    element.addEventListener('scroll', handler, {\n      capture: false,\n      passive: true,\n    })\n\n    return () => {\n      element.removeEventListener('scroll', handler)\n    }\n  }, [element])\n}\n","var props = ['bottom', 'height', 'left', 'right', 'top', 'width'];\n\nvar rectChanged = function rectChanged(a, b) {\n  if (a === void 0) {\n    a = {};\n  }\n\n  if (b === void 0) {\n    b = {};\n  }\n\n  return props.some(function (prop) {\n    return a[prop] !== b[prop];\n  });\n};\n\nvar observedNodes =\n/*#__PURE__*/\nnew Map();\nvar rafId;\n\nvar run = function run() {\n  var changedStates = [];\n  observedNodes.forEach(function (state, node) {\n    var newRect = node.getBoundingClientRect();\n\n    if (rectChanged(newRect, state.rect)) {\n      state.rect = newRect;\n      changedStates.push(state);\n    }\n  });\n  changedStates.forEach(function (state) {\n    state.callbacks.forEach(function (cb) {\n      return cb(state.rect);\n    });\n  });\n  rafId = window.requestAnimationFrame(run);\n};\n\nfunction observeRect(node, cb) {\n  return {\n    observe: function observe() {\n      var wasEmpty = observedNodes.size === 0;\n\n      if (observedNodes.has(node)) {\n        observedNodes.get(node).callbacks.push(cb);\n      } else {\n        observedNodes.set(node, {\n          rect: undefined,\n          hasRectChanged: false,\n          callbacks: [cb]\n        });\n      }\n\n      if (wasEmpty) run();\n    },\n    unobserve: function unobserve() {\n      var state = observedNodes.get(node);\n\n      if (state) {\n        // Remove the callback\n        var index = state.callbacks.indexOf(cb);\n        if (index >= 0) state.callbacks.splice(index, 1); // Remove the node reference\n\n        if (!state.callbacks.length) observedNodes[\"delete\"](node); // Stop the loop\n\n        if (!observedNodes.size) cancelAnimationFrame(rafId);\n      }\n    }\n  };\n}\n\nexport default observeRect;\n//# sourceMappingURL=observe-rect.esm.js.map\n","import React from 'react'\n\nimport observeRect from '@reach/observe-rect'\n\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport default function useRect(nodeRef) {\n  const [element, setElement] = React.useState(nodeRef.current)\n  const [rect, setRect] = React.useState(null)\n  const initialRectSet = React.useRef(false)\n\n  useIsomorphicLayoutEffect(() => {\n    if (nodeRef.current !== element) {\n      setElement(nodeRef.current)\n    }\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    if (element && !initialRectSet.current) {\n      initialRectSet.current = true\n      setRect(element.getBoundingClientRect())\n    }\n  }, [element])\n\n  React.useEffect(() => {\n    if (!element) {\n      return\n    }\n\n    const observer = observeRect(element, setRect)\n\n    observer.observe()\n\n    return () => {\n      observer.unobserve()\n    }\n  }, [element])\n\n  return rect\n}\n","import React from 'react'\n\nimport useScroll from './useScroll'\nimport useRect from './useRect'\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nconst defaultEstimateSize = () => 50\n\nexport function useVirtual({\n  size = 0,\n  estimateSize = defaultEstimateSize,\n  overscan = 0,\n  paddingStart = 0,\n  paddingEnd = 0,\n  parentRef,\n  horizontal,\n  scrollToFn,\n}) {\n  const sizeKey = horizontal ? 'width' : 'height'\n  const scrollKey = horizontal ? 'scrollLeft' : 'scrollTop'\n\n  const { [sizeKey]: outerSize } = useRect(parentRef) || {\n    [sizeKey]: 0,\n  }\n\n  const [scrollOffset, _setScrollOffset] = React.useState(0)\n\n  const scrollOffsetPlusOuterSize = scrollOffset + outerSize\n\n  useScroll(parentRef, ({ [scrollKey]: newScrollOffset }) => {\n    _setScrollOffset(newScrollOffset)\n  })\n\n  const defaultScrollToFn = React.useCallback(\n    offset => {\n      if (parentRef.current) {\n        _setScrollOffset(offset)\n        parentRef.current[scrollKey] = offset\n      }\n    },\n    [parentRef, scrollKey]\n  )\n\n  const resolvedScrollToFn = scrollToFn || defaultScrollToFn\n\n  scrollToFn = React.useCallback(\n    offset => {\n      resolvedScrollToFn(offset, defaultScrollToFn)\n    },\n    [defaultScrollToFn, resolvedScrollToFn]\n  )\n\n  const [measuredCache, setMeasuredCache] = React.useState({})\n\n  const { measurements, reversedMeasurements } = React.useMemo(() => {\n    const measurements = []\n    const reversedMeasurements = []\n\n    for (let i = 0, j = size - 1; i < size; i++, j--) {\n      const start = measurements[i - 1] ? measurements[i - 1].end : paddingStart\n      const size = measuredCache[i] || estimateSize(i)\n      const end = start + size\n      const bounds = { index: i, start, size, end }\n      measurements[i] = {\n        ...bounds,\n      }\n      reversedMeasurements[j] = {\n        ...bounds,\n      }\n    }\n    return { measurements, reversedMeasurements }\n  }, [estimateSize, measuredCache, paddingStart, size])\n\n  const totalSize = (measurements[size - 1]?.end || 0) + paddingEnd\n\n  let start = React.useMemo(\n    () =>\n      reversedMeasurements.reduce(\n        (last, rowStat) => (rowStat.end >= scrollOffset ? rowStat : last),\n        reversedMeasurements[0]\n      ),\n    [reversedMeasurements, scrollOffset]\n  )\n\n  let end = React.useMemo(\n    () =>\n      measurements.reduce(\n        (last, rowStat) =>\n          rowStat.start <= scrollOffsetPlusOuterSize ? rowStat : last,\n        measurements[0]\n      ),\n    [measurements, scrollOffsetPlusOuterSize]\n  )\n\n  let startIndex = start ? start.index : 0\n  let endIndex = end ? end.index : 0\n\n  // Always add at least one overscan item, so focus will work\n  startIndex = Math.max(startIndex - overscan, 0)\n  endIndex = Math.min(endIndex + overscan, size - 1)\n\n  const latestRef = React.useRef({})\n\n  latestRef.current = {\n    measurements,\n    outerSize,\n    scrollOffset,\n    scrollOffsetPlusOuterSize,\n    totalSize,\n  }\n\n  const virtualItems = React.useMemo(() => {\n    const virtualItems = []\n\n    for (let i = startIndex; i <= endIndex; i++) {\n      const measurement = measurements[i]\n\n      const item = {\n        ...measurement,\n        measureRef: el => {\n          const { scrollOffset } = latestRef.current\n\n          if (el) {\n            const { [sizeKey]: measuredSize } = el.getBoundingClientRect()\n\n            if (measuredSize !== item.size) {\n              if (item.start < scrollOffset) {\n                defaultScrollToFn(scrollOffset + (measuredSize - item.size))\n              }\n\n              setMeasuredCache(old => ({\n                ...old,\n                [i]: measuredSize,\n              }))\n            }\n          }\n        },\n      }\n\n      virtualItems.push(item)\n    }\n\n    return virtualItems\n  }, [startIndex, endIndex, measurements, sizeKey, defaultScrollToFn])\n\n  const mountedRef = React.useRef()\n\n  useIsomorphicLayoutEffect(() => {\n    if (mountedRef.current) {\n      if (estimateSize || size) setMeasuredCache({})\n    }\n    mountedRef.current = true\n  }, [estimateSize, size])\n\n  const scrollToOffset = React.useCallback(\n    (toOffset, { align = 'start' } = {}) => {\n      const {\n        outerSize,\n        scrollOffset,\n        scrollOffsetPlusOuterSize,\n      } = latestRef.current\n\n      if (align === 'auto') {\n        if (toOffset <= scrollOffset) {\n          align = 'start'\n        } else if (scrollOffset >= scrollOffsetPlusOuterSize) {\n          align = 'end'\n        } else {\n          align = 'start'\n        }\n      }\n\n      if (align === 'start') {\n        scrollToFn(toOffset)\n      } else if (align === 'end') {\n        scrollToFn(toOffset - outerSize)\n      } else if (align === 'center') {\n        scrollToFn(toOffset - outerSize / 2)\n      }\n    },\n    [scrollToFn]\n  )\n\n  const tryScrollToIndex = React.useCallback(\n    (index, { align = 'auto', ...rest } = {}) => {\n      const {\n        measurements,\n        scrollOffset,\n        scrollOffsetPlusOuterSize,\n      } = latestRef.current\n\n      const measurement = measurements[Math.max(0, Math.min(index, size - 1))]\n\n      if (!measurement) {\n        return\n      }\n\n      if (align === 'auto') {\n        if (measurement.end >= scrollOffsetPlusOuterSize) {\n          align = 'end'\n        } else if (measurement.start <= scrollOffset) {\n          align = 'start'\n        } else {\n          return\n        }\n      }\n\n      const toOffset =\n        align === 'center'\n          ? measurement.start + measurement.size / 2\n          : align === 'end'\n          ? measurement.end\n          : measurement.start\n\n      scrollToOffset(toOffset, { align, ...rest })\n    },\n    [scrollToOffset, size]\n  )\n\n  const scrollToIndex = React.useCallback(\n    (...args) => {\n      // We do a double request here because of\n      // dynamic sizes which can cause offset shift\n      // and end up in the wrong spot. Unfortunately,\n      // we can't know about those dynamic sizes until\n      // we try and render them. So double down!\n      tryScrollToIndex(...args)\n      requestAnimationFrame(() => {\n        tryScrollToIndex(...args)\n      })\n    },\n    [tryScrollToIndex]\n  )\n\n  return {\n    virtualItems,\n    totalSize,\n    scrollToOffset,\n    scrollToIndex,\n  }\n}\n"],"names":["window","React","useLayoutEffect","useEffect","useScroll","nodeRef","onChange","useState","current","element","setElement","onChangeRef","useRef","useIsomorphicLayoutEffect","scrollLeft","scrollTop","handler","e","target","addEventListener","capture","passive","removeEventListener","props","rectChanged","b","observedNodes","run","changedStates","newRect","node","state","rafId","observeRect","cb","observe","wasEmpty","rect","hasRectChanged","callbacks","unobserve","index","cancelAnimationFrame","useRect","setRect","initialRectSet","getBoundingClientRect","observer","defaultEstimateSize","useVirtual","size","estimateSize","overscan","paddingStart","paddingEnd","parentRef","horizontal","scrollToFn","sizeKey","scrollKey","outerSize","scrollOffset","_setScrollOffset","scrollOffsetPlusOuterSize","newScrollOffset","defaultScrollToFn","useCallback","offset","resolvedScrollToFn","measuredCache","setMeasuredCache","useMemo","measurements","reversedMeasurements","i","j","start","end","bounds","totalSize","reduce","last","rowStat","startIndex","endIndex","Math","max","min","latestRef","virtualItems","measurement","item","measureRef","el","measuredSize","old","push","mountedRef","scrollToOffset","toOffset","align","tryScrollToIndex","rest","scrollToIndex","args","requestAnimationFrame"],"mappings":"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"}